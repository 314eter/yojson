USE_OCAMLFIND = true
BYTE_ENABLED = true

FILES[] =
  yojson

OCAMLFLAGS = -dtypes
OCAMLPACKS = easy-format biniou

read.ml: read.mll
	ocamllex read.mll

yojson.mli: yojson.mli.cppo common.mli type.ml write.mli read.mli
	cppo -n yojson.mli.cppo -o yojson.mli

yojson.ml: yojson.ml.cppo common.ml type.ml write.ml read.ml 
	cppo yojson.ml.cppo -o yojson.ml

.DEFAULT: yojson.cma yojson.cmxa # test_yojson meow

.PHONY: clean

clean:
        rm -f *.o *.a *.cm* *~ *.annot test_yojson test_yojson.opt \
		meow meow.opt test.bin read.ml yojson.ml

OCamlLibrary(yojson, $(FILES))
#OCamlProgram(test_yojson, $(FILES) test_yojson)
#OCamlProgram(meow, $(FILES) meow)
